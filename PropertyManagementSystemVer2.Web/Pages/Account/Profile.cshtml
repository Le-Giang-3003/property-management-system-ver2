@page "/Account/Profile"
@model PropertyManagementSystemVer2.Web.Pages.Account.ProfileModel
@{
    ViewData["Title"] = "H·ªì s∆° c√° nh√¢n";
    var userAvatar = string.IsNullOrEmpty(Model.UserProfile.AvatarUrl) 
        ? "https://ui-avatars.com/api/?name=" + Uri.EscapeDataString(Model.UserProfile.FullName) + "&background=6366f1&color=fff" 
        : Model.UserProfile.AvatarUrl;
}

@if (TempData["SuccessMessage"] != null)
{
    <div class="mb-20" style="padding: 12px 16px; background: var(--success-bg); color: var(--success); border-radius: var(--radius-sm); border: 1px solid var(--success);">
        @TempData["SuccessMessage"]
    </div>
}
@if (TempData["ErrorMessage"] != null)
{
    <div class="mb-20" style="padding: 12px 16px; background: var(--danger-bg); color: var(--danger); border-radius: var(--radius-sm); border: 1px solid var(--danger);">
        @TempData["ErrorMessage"]
    </div>
}

<div class="mb-20">
    <div class="page-title">H·ªì s∆° c√° nh√¢n</div>
    <div class="page-desc">Qu·∫£n l√Ω th√¥ng tin t√†i kho·∫£n c·ªßa b·∫°n</div>
</div>

@if (Model.UserRole == "Admin")
{
    <div style="padding: 16px 20px; background: rgba(139, 92, 246, 0.1); border: 1px solid #8b5cf6; border-radius: 12px; margin-bottom: 24px; display: flex; align-items: center; gap: 12px;">
        <i data-feather="shield" style="color: #8b5cf6; width: 24px; height: 24px;"></i>
        <div style="flex: 1;">
            <div style="font-size: 14px; font-weight: 600; margin-bottom: 4px;">T√†i kho·∫£n qu·∫£n tr·ªã vi√™n</div>
            <div style="font-size: 13px; color: var(--text-muted);">B·∫°n c√≥ quy·ªÅn truy c·∫≠p ƒë·∫ßy ƒë·ªß v√†o t·∫•t c·∫£ ch·ª©c nƒÉng qu·∫£n tr·ªã h·ªá th·ªëng</div>
        </div>
    </div>
}
else if (Model.UserRole == "Landlord")
{
    var isVerified = Model.UserProfile.IsIdentityVerified;
    <div style="padding: 16px 20px; background: @(isVerified ? "rgba(16, 185, 129, 0.1)" : "rgba(245, 158, 11, 0.1)"); border: 1px solid @(isVerified ? "#10b981" : "#f59e0b"); border-radius: 12px; margin-bottom: 24px; display: flex; align-items: center; gap: 12px;">
        <i data-feather="@(isVerified ? "check-circle" : "alert-circle")" style="color: @(isVerified ? "#10b981" : "#f59e0b"); width: 24px; height: 24px;"></i>
        <div style="flex: 1;">
            <div style="font-size: 14px; font-weight: 600; margin-bottom: 4px;">
                @(isVerified ? "T√†i kho·∫£n ƒë√£ ƒë∆∞·ª£c x√°c minh" : "T√†i kho·∫£n ch∆∞a x√°c minh ƒë·∫ßy ƒë·ªß")
            </div>
            <div style="font-size: 13px; color: var(--text-muted);">
                @(isVerified ? "B·∫°n c√≥ th·ªÉ ƒëƒÉng b·∫•t ƒë·ªông s·∫£n v√† nh·∫≠n thanh to√°n" : "Vui l√≤ng ho√†n t·∫•t x√°c minh (c·∫≠p nh·∫≠t CMND/CCCD) ƒë·ªÉ s·ª≠ d·ª•ng ƒë·∫ßy ƒë·ªß t√≠nh nƒÉng")
            </div>
        </div>
        @if (!isVerified)
        {
            <button class="btn btn-primary btn-sm" onclick="enableEditMode()">C·∫≠p nh·∫≠t ngay</button>
        }
    </div>
}
else
{
    var isVerified = Model.UserProfile.IsEmailVerified && Model.UserProfile.IsPhoneVerified;
    <div style="padding: 16px 20px; background: @(isVerified ? "rgba(16, 185, 129, 0.1)" : "rgba(245, 158, 11, 0.1)"); border: 1px solid @(isVerified ? "#10b981" : "#f59e0b"); border-radius: 12px; margin-bottom: 24px; display: flex; align-items: center; gap: 12px;">
        <i data-feather="@(isVerified ? "check-circle" : "alert-circle")" style="color: @(isVerified ? "#10b981" : "#f59e0b"); width: 24px; height: 24px;"></i>
        <div style="flex: 1;">
            <div style="font-size: 14px; font-weight: 600; margin-bottom: 4px;">
                @(isVerified ? "T√†i kho·∫£n ƒë√£ ƒë∆∞·ª£c x√°c minh" : "T√†i kho·∫£n ch∆∞a x√°c minh ƒë·∫ßy ƒë·ªß")
            </div>
            <div style="font-size: 13px; color: var(--text-muted);">
                @(isVerified ? "B·∫°n c√≥ th·ªÉ thu√™ b·∫•t ƒë·ªông s·∫£n v√† th·ª±c hi·ªán thanh to√°n" : "Vui l√≤ng ƒë·ª£i h·ªá th·ªëng x√°c minh ƒë·ªÉ s·ª≠ d·ª•ng ƒë·∫ßy ƒë·ªß t√≠nh nƒÉng")
            </div>
        </div>
    </div>
}

<div style="display: flex; flex-direction: column; gap: 16px;">
    <!-- Personal Information Card -->
    <div class="card" style="padding: 28px;">
        <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 24px;">
            <div style="font-size: 16px; font-weight: 700;">Th√¥ng tin c√° nh√¢n</div>
            <div id="viewModeActions">
                <button class="btn btn-primary btn-sm" onclick="enableEditMode()">
                    <i data-feather="edit-2" style="width: 14px; height: 14px; margin-right: 4px;"></i> Ch·ªânh s·ª≠a
                </button>
            </div>
            <div id="editModeActions" style="display: none; gap: 8px;">
                <button class="btn btn-secondary btn-sm" onclick="disableEditMode()">
                    <i data-feather="x" style="width: 14px; height: 14px; margin-right: 4px;"></i> H·ªßy
                </button>
                <button class="btn btn-success btn-sm" onclick="document.getElementById('profileForm').submit()">
                    <i data-feather="save" style="width: 14px; height: 14px; margin-right: 4px;"></i> L∆∞u thay ƒë·ªïi
                </button>
            </div>
        </div>

        <div style="display: grid; grid-template-columns: @(Model.UserRole == "Landlord" ? "280px 1fr" : "1fr"); gap: 32px;">
            @if (Model.UserRole == "Landlord")
            {
                <!-- Left: Avatar & Stats for Landlord -->
                <div>
                    <form method="post" asp-page-handler="UploadAvatar" enctype="multipart/form-data" id="avatarFormLandlord" style="position: relative; width: 160px; height: 160px; margin: 0 auto 16px;">
                        <img src="@userAvatar" alt="@Model.UserProfile.FullName" style="width: 100%; height: 100%; border-radius: 50%; object-fit: cover; border: 4px solid var(--border);" />
                        <label style="position: absolute; bottom: 4px; right: 4px; width: 36px; height: 36px; border-radius: 50%; background: var(--accent); border: 3px solid var(--bg-card); color: white; display: flex; align-items: center; justify-content: center; cursor: pointer; margin: 0;" title="Thay ƒë·ªïi ·∫£nh">
                            <i data-feather="camera" style="width: 16px; height: 16px;"></i>
                            <input type="file" asp-for="AvatarFile" accept="image/*" style="display: none;" onchange="document.getElementById('avatarFormLandlord').submit()" />
                        </label>
                    </form>

                    <div style="text-align: center; margin-bottom: 12px;">
                        <div style="display: inline-block; padding: 4px 12px; border-radius: 16px; font-size: 12px; font-weight: 600; background: #dcfce7; color: #166534;">
                            Ch·ªß nh√†
                        </div>
                    </div>

                    <div style="display: flex; gap: 6px; justify-content: center; margin-bottom: 16px; flex-wrap: wrap;">
                        @if (Model.UserProfile.IsEmailVerified)
                        {
                            <div style="display: flex; align-items: center; gap: 4px; padding: 4px 8px; background: rgba(16, 185, 129, 0.1); border-radius: 12px; font-size: 11px; color: #10b981;">
                                <i data-feather="check-circle" style="width: 12px; height: 12px;"></i> Email
                            </div>
                        }
                        @if (Model.UserProfile.IsPhoneVerified)
                        {
                            <div style="display: flex; align-items: center; gap: 4px; padding: 4px 8px; background: rgba(16, 185, 129, 0.1); border-radius: 12px; font-size: 11px; color: #10b981;">
                                <i data-feather="check-circle" style="width: 12px; height: 12px;"></i> SƒêT
                            </div>
                        }
                        @if (Model.UserProfile.IsIdentityVerified)
                        {
                            <div style="display: flex; align-items: center; gap: 4px; padding: 4px 8px; background: rgba(16, 185, 129, 0.1); border-radius: 12px; font-size: 11px; color: #10b981;">
                                <i data-feather="check-circle" style="width: 12px; height: 12px;"></i> CCCD
                            </div>
                        }
                    </div>

                    <div style="font-size: 11px; color: var(--text-muted); margin-bottom: 16px; text-align: center;">
                        M√£ ch·ªß nh√†: #@Model.UserProfile.Id
                    </div>

                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px; padding: 16px 0; border-top: 1px solid var(--border); border-bottom: 1px solid var(--border); margin-bottom: 16px;">
                        <div style="text-align: center;">
                            <div style="font-size: 24px; font-weight: 700; color: var(--accent);">
                                @Model.LandlordStats.TotalProperties
                            </div>
                            <div style="font-size: 11px; color: var(--text-muted);">BƒêS s·ªü h·ªØu</div>
                        </div>
                        <div style="text-align: center;">
                            <div style="font-size: 24px; font-weight: 700; color: #10b981;">
                                @Model.LandlordStats.RentedCount
                            </div>
                            <div style="font-size: 11px; color: var(--text-muted);">ƒêang cho thu√™</div>
                        </div>
                    </div>

                    <button class="btn btn-secondary" style="width: 100%;" onclick="document.getElementById('passwordModal').style.display='flex'">
                        <i data-feather="lock" style="width: 16px; height: 16px; margin-right: 4px;"></i> ƒê·ªïi m·∫≠t kh·∫©u
                    </button>
                </div>
            }

            <form method="post" asp-page-handler="UpdateProfile" id="profileForm">
                @if (Model.UserRole != "Landlord")
                {
                    <div style="text-align: center; margin-bottom: 32px;">
                        <form method="post" asp-page-handler="UploadAvatar" enctype="multipart/form-data" id="avatarForm" style="position: relative; width: 120px; height: 120px; margin: 0 auto 16px;">
                            <img src="@userAvatar" alt="@Model.UserProfile.FullName" style="width: 100%; height: 100%; border-radius: 50%; object-fit: cover; border: 4px solid var(--border);" />
                            <label style="position: absolute; bottom: 0; right: 0; width: 32px; height: 32px; border-radius: 50%; background: var(--accent); border: 3px solid var(--bg-card); color: white; display: flex; align-items: center; justify-content: center; cursor: pointer; margin: 0;" title="Thay ƒë·ªïi ·∫£nh">
                                <i data-feather="camera" style="width: 14px; height: 14px;"></i>
                                <input type="file" asp-for="AvatarFile" accept="image/*" style="display: none;" onchange="document.getElementById('avatarForm').submit()" />
                            </label>
                        </form>
                        <div style="margin-bottom: 12px;">
                            <div style="display: inline-block; padding: 4px 12px; border-radius: 16px; font-size: 12px; font-weight: 600; @(Model.UserRole == "Admin" ? "background: #f3e8ff; color: #6b21a8;" : "background: #dbeafe; color: #1e40af;")">
                                @(Model.UserRole == "Admin" ? "Qu·∫£n tr·ªã vi√™n" : "Ng∆∞·ªùi thu√™")
                            </div>
                        </div>
                        <div style="display: flex; gap: 8px; justify-content: center; margin-bottom: 8px; flex-wrap: wrap;">
                            @if (Model.UserProfile.IsEmailVerified)
                            {
                                <div style="display: flex; align-items: center; gap: 4px; padding: 4px 10px; background: rgba(16, 185, 129, 0.1); border-radius: 12px; font-size: 11px; color: #10b981;">
                                    <i data-feather="check-circle" style="width: 12px; height: 12px;"></i> Email
                                </div>
                            }
                            @if (Model.UserProfile.IsPhoneVerified)
                            {
                                <div style="display: flex; align-items: center; gap: 4px; padding: 4px 10px; background: rgba(16, 185, 129, 0.1); border-radius: 12px; font-size: 11px; color: #10b981;">
                                    <i data-feather="check-circle" style="width: 12px; height: 12px;"></i> SƒêT
                                </div>
                            }
                        </div>
                        <div style="font-size: 11px; color: var(--text-muted);">M√£ t√†i kho·∫£n: #@Model.UserProfile.Id</div>
                    </div>
                }

                <div style="display: grid; grid-template-columns: repeat(@(Model.UserRole == "Landlord" ? "2" : "3"), 1fr); gap: 18px; margin-bottom: 24px;">
                    <div class="form-group">
                        <label class="form-label">
                            <i data-feather="user" style="width: 14px; height: 14px; margin-right: 6px; vertical-align: middle;"></i> H·ªç v√† t√™n *
                        </label>
                        <input class="form-control profile-input" asp-for="UpdateForm.FullName" required disabled />
                    </div>

                    <div class="form-group">
                        <label class="form-label">
                            <i data-feather="mail" style="width: 14px; height: 14px; margin-right: 6px; vertical-align: middle;"></i> Email *
                        </label>
                        <input class="form-control" value="@Model.UserProfile.Email" disabled />
                    </div>

                    <div class="form-group">
                        <label class="form-label">
                            <i data-feather="phone" style="width: 14px; height: 14px; margin-right: 6px; vertical-align: middle;"></i> S·ªë ƒëi·ªán tho·∫°i *
                        </label>
                        <input class="form-control profile-input" asp-for="UpdateForm.PhoneNumber" required disabled />
                    </div>

                    <div class="form-group">
                        <label class="form-label">
                            <i data-feather="calendar" style="width: 14px; height: 14px; margin-right: 6px; vertical-align: middle;"></i> Ng√†y tham gia
                        </label>
                        <input class="form-control" type="date" value="@Model.UserProfile.CreatedAt.ToString("yyyy-MM-dd")" disabled />
                    </div>

                    <div class="form-group">
                        <label class="form-label">
                            <i data-feather="credit-card" style="width: 14px; height: 14px; margin-right: 6px; vertical-align: middle;"></i> CMND/CCCD
                        </label>
                        <input class="form-control profile-input" asp-for="UpdateForm.IdentityNumber" disabled />
                    </div>

                    <div class="form-group" style="grid-column: 1 / -1;">
                        <label class="form-label">
                            <i data-feather="map-pin" style="width: 14px; height: 14px; margin-right: 6px; vertical-align: middle;"></i> ƒê·ªãa ch·ªâ li√™n h·ªá
                        </label>
                        <input class="form-control profile-input" asp-for="UpdateForm.Address" disabled />
                    </div>
                    
                    <input type="hidden" asp-for="UpdateForm.AvatarUrl" />
                    @if (Model.UserRole == "Landlord")
                    {
                        <input type="hidden" asp-for="UpdateForm.BankName" />
                        <input type="hidden" asp-for="UpdateForm.BankAccountNumber" />
                        <input type="hidden" asp-for="UpdateForm.BankAccountHolder" />
                    }
                </div>

                @if (Model.UserRole != "Landlord")
                {
                    <div style="border-top: 1px solid var(--border); padding-top: 24px; text-align: center;">
                        <button type="button" class="btn btn-secondary" onclick="document.getElementById('passwordModal').style.display='flex'">
                            <i data-feather="lock" style="width: 16px; height: 16px; margin-right: 4px;"></i> ƒê·ªïi m·∫≠t kh·∫©u
                        </button>
                    </div>
                }
            </form>
        </div>
    </div>

    @if (Model.UserRole == "Landlord")
    {
        <!-- Banking Information Card (Landlord Only) -->
        <div class="card" style="padding: 28px;">
            <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 20px;">
                <div style="font-size: 16px; font-weight: 700;">Th√¥ng tin ng√¢n h√†ng</div>
                <div id="viewModeBankActions">
                    <button class="btn btn-primary btn-sm" onclick="enableBankEditMode()">
                        <i data-feather="edit-2" style="width: 14px; height: 14px; margin-right: 4px;"></i> Ch·ªânh s·ª≠a
                    </button>
                </div>
                <div id="editModeBankActions" style="display: none; gap: 8px;">
                    <button class="btn btn-secondary btn-sm" onclick="disableBankEditMode()">
                        <i data-feather="x" style="width: 14px; height: 14px; margin-right: 4px;"></i> H·ªßy
                    </button>
                    <!-- Instead of duplicate save, we just submit the bank form. So we separate the bank save endpoint. Actually, both use UpdateProfileDto, we can use a separate form for Bank info. -->
                    <button class="btn btn-success btn-sm" onclick="document.getElementById('bankForm').submit()">
                        <i data-feather="save" style="width: 14px; height: 14px; margin-right: 4px;"></i> L∆∞u thay ƒë·ªïi
                    </button>
                </div>
            </div>

            <form method="post" asp-page-handler="UpdateProfile" id="bankForm">
                <input type="hidden" asp-for="UpdateForm.FullName" value="@Model.UserProfile.FullName" />
                <input type="hidden" asp-for="UpdateForm.PhoneNumber" value="@Model.UserProfile.PhoneNumber" />
                <input type="hidden" asp-for="UpdateForm.Address" value="@Model.UserProfile.Address" />
                <input type="hidden" asp-for="UpdateForm.AvatarUrl" value="@Model.UserProfile.AvatarUrl" />
                <input type="hidden" asp-for="UpdateForm.IdentityNumber" value="@Model.UserProfile.IdentityNumber" />

                <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 18px;">
                    <div class="form-group">
                        <label class="form-label">
                            <i data-feather="credit-card" style="width: 14px; height: 14px; margin-right: 6px; vertical-align: middle;"></i> Ng√¢n h√†ng *
                        </label>
                        <input class="form-control bank-input" asp-for="UpdateForm.BankName" placeholder="VD: Vietcombank" required disabled />
                    </div>

                    <div class="form-group">
                        <label class="form-label">
                            <i data-feather="credit-card" style="width: 14px; height: 14px; margin-right: 6px; vertical-align: middle;"></i> S·ªë t√†i kho·∫£n *
                        </label>
                        <input class="form-control bank-input" asp-for="UpdateForm.BankAccountNumber" placeholder="Nh·∫≠p s·ªë t√†i kho·∫£n..." required disabled />
                    </div>

                    <div class="form-group" style="grid-column: 1 / -1;">
                        <label class="form-label">
                            <i data-feather="user" style="width: 14px; height: 14px; margin-right: 6px; vertical-align: middle;"></i> Ch·ªß t√†i kho·∫£n *
                        </label>
                        <input class="form-control bank-input" asp-for="UpdateForm.BankAccountHolder" placeholder="VD: NGUYEN VAN A" required disabled />
                    </div>
                </div>
            </form>

            <div style="margin-top: 20px; padding: 14px; background: rgba(16, 185, 129, 0.05); border: 1px solid rgba(16, 185, 129, 0.2); border-radius: 8px; font-size: 12px; color: var(--text-muted);">
                üí° <strong>L∆∞u √Ω:</strong> Th√¥ng tin ng√¢n h√†ng ƒë∆∞·ª£c s·ª≠ d·ª•ng ƒë·ªÉ nh·∫≠n thanh to√°n ti·ªÅn thu√™ t·ª´ ng∆∞·ªùi thu√™ m·ªôt c√°ch an to√†n.
            </div>
        </div>
    }
</div>

<!-- Password Change Modal -->
<div class="modal-overlay" id="passwordModal" style="display: none;" onclick="this.style.display='none'">
    <div class="modal" onclick="event.stopPropagation()">
        <form method="post" asp-page-handler="ChangePassword" id="changePasswordForm" onsubmit="return validatePassword(event)">
            <div class="modal-header">
                <span class="modal-title">ƒê·ªïi m·∫≠t kh·∫©u</span>
                <button type="button" class="modal-close btn btn-ghost btn-sm btn-icon" onclick="document.getElementById('passwordModal').style.display='none'">
                    <i data-feather="x"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">M·∫≠t kh·∫©u hi·ªán t·∫°i *</label>
                    <input type="password" class="form-control" asp-for="PasswordForm.CurrentPassword" placeholder="Nh·∫≠p m·∫≠t kh·∫©u hi·ªán t·∫°i..." required />
                </div>
                <div class="form-group">
                    <label class="form-label">M·∫≠t kh·∫©u m·ªõi *</label>
                    <input type="password" class="form-control" asp-for="PasswordForm.NewPassword" placeholder="Nh·∫≠p m·∫≠t kh·∫©u m·ªõi..." required />
                </div>
                <div class="form-group">
                    <label class="form-label">X√°c nh·∫≠n m·∫≠t kh·∫©u m·ªõi *</label>
                    <input type="password" class="form-control" asp-for="PasswordForm.ConfirmPassword" id="confirmPasswordInput" placeholder="Nh·∫≠p l·∫°i m·∫≠t kh·∫©u m·ªõi..." required />
                </div>
                
                <div id="passwordErrorMsg" style="display: none; padding: 12px; background: rgba(239, 68, 68, 0.1); border: 1px solid #ef4444; border-radius: 8px; font-size: 13px; color: #ef4444; margin-bottom: 12px;">
                </div>

                <div style="padding: 12px; background: rgba(59, 130, 246, 0.1); border: 1px solid #3b82f6; border-radius: 8px; font-size: 12px; color: var(--text-muted);">
                    üí° <strong>L∆∞u √Ω:</strong> M·∫≠t kh·∫©u ph·∫£i c√≥ √≠t nh·∫•t 8 k√Ω t·ª±, bao g·ªìm ch·ªØ hoa, ch·ªØ th∆∞·ªùng, s·ªë v√† k√Ω t·ª± ƒë·∫∑c bi·ªát.
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="document.getElementById('passwordModal').style.display='none'">H·ªßy</button>
                <button type="submit" class="btn btn-primary">
                    <i data-feather="lock" style="width: 14px; height: 14px; margin-right: 4px;"></i> L∆∞u m·∫≠t kh·∫©u
                </button>
            </div>
        </form>
    </div>
</div>

@section Scripts {
    <script>
        function enableEditMode() {
            document.querySelectorAll('.profile-input').forEach(el => el.disabled = false);
            document.getElementById('viewModeActions').style.display = 'none';
            document.getElementById('editModeActions').style.display = 'flex';
        }

        function disableEditMode() {
            document.querySelectorAll('.profile-input').forEach(el => el.disabled = true);
            document.getElementById('viewModeActions').style.display = 'block';
            document.getElementById('editModeActions').style.display = 'none';
        }

        function enableBankEditMode() {
            document.querySelectorAll('.bank-input').forEach(el => el.disabled = false);
            document.getElementById('viewModeBankActions').style.display = 'none';
            document.getElementById('editModeBankActions').style.display = 'flex';
        }

        function disableBankEditMode() {
            document.querySelectorAll('.bank-input').forEach(el => el.disabled = true);
            document.getElementById('viewModeBankActions').style.display = 'block';
            document.getElementById('editModeBankActions').style.display = 'none';
        }

        function validatePassword(event) {
            const newPassword = document.getElementById('PasswordForm_NewPassword').value;
            const confirmPassword = document.getElementById('confirmPasswordInput').value;
            const errorBlock = document.getElementById('passwordErrorMsg');

            // Regex checks
            const hasUppercase = /[A-Z]/.test(newPassword);
            const hasLowercase = /[a-z]/.test(newPassword);
            const hasNumbers = /\d/.test(newPassword);
            const hasSpecial = /[!@@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]+/.test(newPassword);
            const isLongEnough = newPassword.length >= 8;

            let errorStr = "";

            if (!isLongEnough || !hasUppercase || !hasLowercase || !hasNumbers || !hasSpecial) {
                errorStr = "M·∫≠t kh·∫©u m·ªõi kh√¥ng ƒë·ªß m·∫°nh. Ph·∫£i c√≥ √≠t nh·∫•t 8 k√Ω t·ª±, g·ªìm √≠t nh·∫•t 1 ch·ªØ hoa, 1 ch·ªØ th∆∞·ªùng, 1 s·ªë v√† 1 k√Ω t·ª± ƒë·∫∑c bi·ªát.";
            } else if (newPassword !== confirmPassword) {
                errorStr = "M·∫≠t kh·∫©u x√°c nh·∫≠n kh√¥ng kh·ªõp. Vui l√≤ng th·ª≠ l·∫°i.";
            }

            if (errorStr.length > 0) {
                errorBlock.style.display = 'block';
                errorBlock.innerText = errorStr;
                event.preventDefault();
                return false;
            }

            errorBlock.style.display = 'none';
            return true;
        }
    </script>
}
