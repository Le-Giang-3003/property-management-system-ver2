@page
@model PropertyManagementSystemVer2.Web.Pages.Account.RegisterModel
@{
    Layout = null;
    ViewData["Title"] = "ƒêƒÉng k√Ω t√†i kho·∫£n";
}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>PropertyMS - @ViewData["Title"]</title>
    <!-- CSS t·ª´ UI -->
    <link rel="stylesheet" href="~/css/site.css" asp-append-version="true" />
    <style>
        .register-wrapper {
            min-height: 100vh;
            background: var(--bg-primary);
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 40px 20px;
        }
        .orb-left {
            position: fixed; top: 10%; left: 15%; width: 300px; height: 300px;
            background: radial-gradient(circle, rgba(99,102,241,0.15) 0%, transparent 70%);
            pointer-events: none;
        }
        .orb-right {
            position: fixed; bottom: 20%; right: 10%; width: 400px; height: 400px;
            background: radial-gradient(circle, rgba(16,185,129,0.1) 0%, transparent 70%);
            pointer-events: none;
        }
        .register-content {
            width: 100%; max-width: 520px; position: relative; z-index: 1;
        }
        .back-btn {
            display: flex; align-items: center; gap: 8px; background: transparent; border: none;
            color: var(--text-muted); font-size: 14px; cursor: pointer; margin-bottom: 20px;
            padding: 8px 12px; border-radius: 8px; transition: all 0.2s; text-decoration: none;
        }
        .back-btn:hover {
            background: var(--bg-hover); color: var(--text-primary);
        }
        .logo-box { text-align: center; margin-bottom: 32px; }
        .logo-icon {
            width: 60px; height: 60px; background: linear-gradient(135deg, #6366f1, #8b5cf6);
            border-radius: 16px; display: flex; align-items: center; justify-content: center;
            font-size: 28px; margin: 0 auto 12px; box-shadow: 0 8px 32px rgba(99,102,241,0.4);
        }
        .logo-text {
            font-size: 28px; font-weight: 800; background: linear-gradient(135deg, #6366f1, #818cf8);
            -webkit-background-clip: text; -webkit-text-fill-color: transparent; margin-bottom: 6px;
        }
        .logo-desc { color: var(--text-muted); font-size: 14px; }
        .form-card {
            background: var(--bg-secondary); border: 1px solid var(--border);
            border-radius: 16px; padding: 24px;
        }
        
        .role-card {
            flex: 1; display: flex; flex-direction: column; align-items: center; gap: 8px; 
            padding: 16px; border: 2px solid var(--border); border-radius: 12px; cursor: pointer; 
            transition: all 0.2s; background: var(--bg-card);
        }
        .role-card.active[data-role="Tenant"] {
            border-color: #3b82f6; background: rgba(59, 130, 246, 0.15);
        }
        .role-card.active[data-role="Landlord"] {
            border-color: #10b981; background: rgba(16, 185, 129, 0.15);
        }
        
        .validation-message {
            color: var(--danger); font-size: 12px; margin-top: 6px; display: block;
        }
    </style>
</head>
<body>
    <div class="register-wrapper">
        <div class="orb-left"></div>
        <div class="orb-right"></div>
        <div class="register-content">
            <a href="/Account/Login" class="back-btn">
                ‚Üê Quay l·∫°i ƒëƒÉng nh·∫≠p
            </a>

            <div class="logo-box">
                <div class="logo-icon">üè¢</div>
                <h1 class="logo-text">T·∫°o t√†i kho·∫£n</h1>
                <p class="logo-desc">ƒêƒÉng k√Ω ƒë·ªÉ s·ª≠ d·ª•ng PropertyMS</p>
            </div>

            @if (!string.IsNullOrEmpty(Model.ErrorMessage))
            {
                <div style="background: var(--danger-bg); border: 1px solid var(--danger); color: var(--danger); padding: 12px; border-radius: 8px; margin-bottom: 16px; font-size: 13px;">
                    @Model.ErrorMessage
                </div>
            }
            @if (!string.IsNullOrEmpty(Model.SuccessMessage))
            {
                <div style="background: rgba(16, 185, 129, 0.1); border: 1px solid var(--success); color: var(--success); padding: 12px; border-radius: 8px; margin-bottom: 16px; font-size: 13px;">
                    @Model.SuccessMessage
                </div>
            }

            <div class="form-card">
                @if (Model.ActionType == "Success")
                {
                    <div style="text-align: center; padding: 20px 0;">
                        <div style="font-size: 48px; margin-bottom: 16px;">üéâ</div>
                        <h3 style="color: var(--text-primary); margin-bottom: 8px;">T·∫°o t√†i kho·∫£n th√†nh c√¥ng!</h3>
                        <p style="color: var(--text-muted); font-size: 14px; margin-bottom: 24px;">B·∫°n ƒë√£ c√≥ th·ªÉ ƒëƒÉng nh·∫≠p v√† tr·∫£i nghi·ªám c√°c t√≠nh nƒÉng c·ªßa PropertyMS.</p>
                        <a href="/Account/Login" class="btn btn-primary" style="text-decoration: none; padding: 12px 24px;">ƒê·∫øn trang ƒëƒÉng nh·∫≠p</a>
                    </div>
                }
                else
                {
                    <form method="post">
                        <input type="hidden" asp-for="ActionType" />
                        
                        @if (Model.ActionType == "Verify")
                        {
                            <!-- Hidden fields to persist user info -->
                            <input type="hidden" asp-for="RegisterForm.Role" />
                            <input type="hidden" asp-for="RegisterForm.FullName" />
                            <input type="hidden" asp-for="RegisterForm.Email" />
                            <input type="hidden" asp-for="RegisterForm.PhoneNumber" />
                            <input type="hidden" asp-for="RegisterForm.Password" />
                            <input type="hidden" asp-for="RegisterForm.ConfirmPassword" />

                            <div style="text-align: center; margin-bottom: 24px;">
                                <div style="font-size: 40px; margin-bottom: 12px;">‚úâÔ∏è</div>
                                <h4 style="color: var(--text-primary); margin-bottom: 8px;">X√°c th·ª±c Email</h4>
                                <p style="color: var(--text-muted); font-size: 14px; line-height: 1.5;">Vui l√≤ng nh·∫≠p m√£ OTP 6 s·ªë ƒë√£ ƒë∆∞·ª£c g·ª≠i ƒë·∫øn <br><b style="color: var(--accent);">@Model.RegisterForm.Email</b></p>
                            </div>

                            <div class="form-group">
                                <label class="form-label" asp-for="RegisterForm.OtpCode">M√£ OTP *</label>
                                <input class="form-control" asp-for="RegisterForm.OtpCode" type="text" placeholder="V√≠ d·ª•: 123456" maxlength="6" style="text-align: center; letter-spacing: 4px; font-size: 20px;" />
                            </div>

                            <button type="submit" class="btn btn-primary" style="width: 100%; justify-content: center; padding: 12px; font-size: 14px; margin-top: 8px;">
                                Ho√†n t·∫•t ƒëƒÉng k√Ω
                            </button>
                            
                            <div style="text-align: center; margin-top: 16px;">
                                <button type="button" onclick="document.getElementById('ActionType').value='Edit'; document.forms[0].submit();" style="background: none; border: none; color: var(--text-muted); text-decoration: underline; cursor: pointer; font-size: 13px;">
                                    ƒê·ªïi th√¥ng tin / Ch∆∞a nh·∫≠n ƒë∆∞·ª£c m√£
                                </button>
                            </div>
                        }
                        else
                        {
                            <!-- Role Selection -->
                            <div class="form-group">
                                <label class="form-label">B·∫°n l√† *</label>
                                <div style="display: flex; gap: 12px;">
                                    <!-- Tenant -->
                                    <label class="role-card @(Model.RegisterForm.Role == "Tenant" ? "active" : "")" data-role="Tenant">
                                        <input type="radio" asp-for="RegisterForm.Role" value="Tenant" style="display:none;" />
                                        <div style="font-size: 32px; margin-bottom: 4px;">üë§</div>
                                        <div style="font-weight: 600; font-size: 14px; color: var(--text-primary);">Ng∆∞·ªùi thu√™</div>
                                        <div style="font-size: 11px; color: var(--text-muted); text-align: center; line-height: 1.4;">T√¨m ki·∫øm t√†i s·∫£n</div>
                                    </label>
                                    <!-- Landlord -->
                                    <label class="role-card @(Model.RegisterForm.Role == "Landlord" ? "active" : "")" data-role="Landlord">
                                        <input type="radio" asp-for="RegisterForm.Role" value="Landlord" style="display:none;" />
                                        <div style="font-size: 32px; margin-bottom: 4px;">üè†</div>
                                        <div style="font-weight: 600; font-size: 14px; color: var(--text-primary);">Ch·ªß nh√†</div>
                                        <div style="font-size: 11px; color: var(--text-muted); text-align: center; line-height: 1.4;">ƒêƒÉng cho thu√™ t√†i s·∫£n</div>
                                    </label>
                                </div>
                            </div>

                            <div class="form-group">
                                <label class="form-label" asp-for="RegisterForm.FullName">H·ªç v√† t√™n *</label>
                                <input class="form-control" asp-for="RegisterForm.FullName" type="text" placeholder="Nguy·ªÖn VƒÉn A" />
                                <span asp-validation-for="RegisterForm.FullName" class="validation-message"></span>
                            </div>

                            <div class="form-group">
                                <label class="form-label" asp-for="RegisterForm.Email">Email *</label>
                                <input class="form-control" asp-for="RegisterForm.Email" type="email" placeholder="email@example.com" />
                                <span asp-validation-for="RegisterForm.Email" class="validation-message"></span>
                            </div>

                            <div class="form-group">
                                <label class="form-label" asp-for="RegisterForm.PhoneNumber">S·ªë ƒëi·ªán tho·∫°i *</label>
                                <input class="form-control" asp-for="RegisterForm.PhoneNumber" type="tel" placeholder="0912345678" />
                                <span asp-validation-for="RegisterForm.PhoneNumber" class="validation-message"></span>
                            </div>

                            <div class="form-group">
                                <label class="form-label" asp-for="RegisterForm.Password">M·∫≠t kh·∫©u *</label>
                                <input class="form-control" asp-for="RegisterForm.Password" type="password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" />
                                <span asp-validation-for="RegisterForm.Password" class="validation-message"></span>
                            </div>

                            <div class="form-group">
                                <label class="form-label" asp-for="RegisterForm.ConfirmPassword">X√°c nh·∫≠n m·∫≠t kh·∫©u *</label>
                                <input class="form-control" asp-for="RegisterForm.ConfirmPassword" type="password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" />
                                <span asp-validation-for="RegisterForm.ConfirmPassword" class="validation-message"></span>
                            </div>

                            <button type="submit" class="btn btn-primary" style="width: 100%; justify-content: center; padding: 12px; font-size: 14px; margin-top: 8px;">
                                ƒêƒÉng k√Ω
                            </button>

                            <div style="text-align: center; margin-top: 16px; font-size: 13px; color: var(--text-muted);">
                                ƒê√£ c√≥ t√†i kho·∫£n? <a href="/Account/Login" style="color: var(--accent); font-weight: 600; text-decoration: none;">ƒêƒÉng nh·∫≠p ngay</a>
                            </div>
                        }
                    </form>
                }
            </div>
            
            <div style="text-align: center; margin-top: 16px; font-size: 12px; color: var(--text-muted);">
                &copy; 2026 PropertyMS - PRN222 Application
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="~/lib/jquery/dist/jquery.min.js"></script>
    <script src="~/lib/jquery-validation/dist/jquery.validate.min.js"></script>
    <script src="~/lib/jquery-validation-unobtrusive/jquery.validate.unobtrusive.min.js"></script>
    
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            var roleCards = document.querySelectorAll('.role-card');
            roleCards.forEach(function(card) {
                card.addEventListener('click', function() {
                    roleCards.forEach(function(c) { c.classList.remove('active'); });
                    this.classList.add('active');
                });
            });
        });
    </script>
</body>
</html>
